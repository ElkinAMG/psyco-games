"use strict";(self.webpackChunkpsy_minigames=self.webpackChunkpsy_minigames||[]).push([[519],{692:()=>{class e{#e;#t;#l;#i;#s;constructor(e,t,l){this.#e=e,this.#t=t,this.#l=l}get x(){return this.#t}get y(){return this.#l}get tile(){return this.#i}set tile(e){this.#i=e,null!=e&&(this.#i.x=this.#t,this.#i.y=this.#l)}get mergeTile(){return this.#s}set mergeTile(e){this.#s=e,null!=e&&(this.#s.x=this.#t,this.#s.y=this.#l)}canAccept(e){return null==this.tile||null==this.mergeTile&&this.tile.value===e.value}mergeTiles(){null!=this.tile&&null!=this.mergeTile&&(this.tile.value=this.tile.value+this.mergeTile.value,this.mergeTile.remove(),this.mergeTile=null)}}class t{#n;#t;#l;#r;constructor(e,t=(Math.random()>.5?2:4)){this.#n=document.createElement("div"),this.#n.classList.add("tile"),e.append(this.#n),this.value=t}get value(){return this.#r}set value(e){this.#r=e,this.#n.textContent=e;const t=100-9*Math.log2(e);this.#n.style.setProperty("--background-lightness",`${t}%`),this.#n.style.setProperty("--text-lightness",(t<=50?90:10)+"%")}set x(e){this.#t=e,this.#n.style.setProperty("--x",e)}set y(e){this.#l=e,this.#n.style.setProperty("--y",e)}remove(){this.#n.remove()}waitForTransition(e=!1){return new Promise((t=>{this.#n.addEventListener(e?"animationend":"transitionend",t,{once:!0})}))}}const l=document.getElementById("game-board"),i=new class{#o;constructor(t){t.style.setProperty("--grid-size",4),t.style.setProperty("--cell-size","12vmin"),t.style.setProperty("--cell-gap","2vmin"),this.#o=function(e){const t=[];for(let l=0;l<16;l++){const l=document.createElement("div");l.classList.add("cell"),t.push(l),e.append(l)}return t}(t).map(((t,l)=>new e(t,l%4,Math.floor(l/4))))}get cells(){return this.#o}get cellsByRow(){return this.#o.reduce(((e,t)=>(e[t.y]=e[t.y]||[],e[t.y][t.x]=t,e)),[])}get cellsByColumn(){return this.#o.reduce(((e,t)=>(e[t.x]=e[t.x]||[],e[t.x][t.y]=t,e)),[])}get#a(){return this.#o.filter((e=>null==e.tile))}randomEmptyCell(){const e=Math.floor(Math.random()*this.#a.length);return this.#a[e]}}(l);function s(){window.addEventListener("keydown",n,{once:!0})}async function n(e){switch(e.key){case"ArrowUp":if(!o())return void s();await r(i.cellsByColumn);break;case"ArrowDown":if(!a())return void s();await r(i.cellsByColumn.map((e=>[...e].reverse())));break;case"ArrowLeft":if(!c())return void s();await r(i.cellsByRow);break;case"ArrowRight":if(!u())return void s();await r(i.cellsByRow.map((e=>[...e].reverse())));break;default:return void s()}i.cells.forEach((e=>e.mergeTiles()));const n=new t(l);i.randomEmptyCell().tile=n,o()||a()||c()||u()?s():n.waitForTransition(!0).then((()=>{alert("Â¡Perdiste!")}))}function r(e){return Promise.all(e.flatMap((e=>{const t=[];for(let l=1;l<e.length;l++){const i=e[l];if(null==i.tile)continue;let s;for(let t=l-1;t>=0;t--){const l=e[t];if(!l.canAccept(i.tile))break;s=l}null!=s&&(t.push(i.tile.waitForTransition()),null!=s.tile?s.mergeTile=i.tile:s.tile=i.tile,i.tile=null)}return t})))}function o(){return m(i.cellsByColumn)}function a(){return m(i.cellsByColumn.map((e=>[...e].reverse())))}function c(){return m(i.cellsByRow)}function u(){return m(i.cellsByRow.map((e=>[...e].reverse())))}function m(e){return e.some((e=>e.some(((t,l)=>0!==l&&(null!=t.tile&&e[l-1].canAccept(t.tile))))))}i.randomEmptyCell().tile=new t(l),i.randomEmptyCell().tile=new t(l),s()}},e=>{e.O(0,[378],(()=>(692,e(e.s=692)))),e.O()}]);